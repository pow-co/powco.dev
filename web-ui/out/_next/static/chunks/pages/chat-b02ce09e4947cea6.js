(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{7722:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return t(360)}])},360:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var r=t(5893),a=t(7294),c=(t(9367),t(8100)),o=t(445),s=t(2473);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(){var e="powco",n=(0,a.useState)([]),t=n[0],u=n[1];(0,a.useEffect)((function(){var n={v:3,q:{find:{"MAP.type":"message","MAP.channel":e},project:{out:0,in:0}}},t=btoa(JSON.stringify(n)),r="https://b.map.sv/s/".concat(t);if("undefined"!==typeof EventSource){var a=new EventSource(r);a.onmessage=function(e){var n=JSON.parse(e.data);if("push"===n.type){var t=n.data[0];console.log(t);var r={tx_id:t.tx.h,timestamp:t.timestamp,content:t.B.content,channel:t.MAP.channel,user:t.AIP?t.AIP.address:t.MAP.paymail};(0,c.JG)("http://localhost:5200",r,!1)}},a.onerror=function(e){e.data&&console.log("stream.error",e.data)}}}),[]);var l=(0,s.Ek)("/messages?channel=".concat(e)),f=l.data,d=l.error,p=l.loading;(0,a.useEffect)((function(){!d&&!p&&u(f.messages)}),[f,p]);var v=(0,a.useRef)(null);return(0,a.useEffect)((function(){v.current.scrollIntoView(!1)}),[t,v]),(0,r.jsx)(o.g7,{children:(0,r.jsxs)("div",{className:"flex flex-col col-span-12 lg:col-span-6 min-h-screen",children:[(0,r.jsx)("div",{className:"grow flex flex-col-reverse pt-5 ",children:t.length>0&&t.map((function(e){return(0,r.jsx)(o.Ky,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){i(e,n,t[n])}))}return e}({},e),e.tx_id)}))}),(0,r.jsx)("div",{className:"sticky bottom-0 bg-gray-300 dark:bg-gray-700",children:(0,r.jsx)(o.W,{})}),(0,r.jsx)("div",{ref:v})]})})}}},function(e){e.O(0,[374,774,888,179],(function(){return n=7722,e(e.s=n);var n}));var n=e.O();_N_E=n}]);